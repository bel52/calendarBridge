on run
    -- Set up paths
    set homePath to path to home folder as text
    set outboxPath to homePath & "calendarBridge:outbox:"
    set posixOutbox to POSIX path of (path to home folder) & "calendarBridge/outbox/"
    
    -- Clean outbox folder
    do shell script "mkdir -p " & quoted form of posixOutbox
    do shell script "rm -f " & quoted form of posixOutbox & "*.ics"
    
    tell application "Microsoft Outlook"
        -- Use the second calendar named "Calendar"
        set calList to calendars whose name is "Calendar"
        set targetCal to item 2 of calList
        
        set allEvents to calendar events of targetCal
        set today to current date
        set futureLimit to today + (60 * days)
        
        set exportedCount to 0
        set indexCount to 0
        
        repeat with evt in allEvents
            set indexCount to indexCount + 1
            try
                set startTime to start time of evt
                if (startTime > today) and (startTime < futureLimit) then
                    set fileName to "event_" & indexCount & ".ics"
                    set filePath to outboxPath & fileName
                    save evt in file filePath as "ics"
                    set exportedCount to exportedCount + 1
                end if
            on error
                -- skip bad event
            end try
        end repeat
        
        display notification "Exported " & exportedCount & " events" with title "Calendar Bridge"
        return "âœ… Exported " & exportedCount & " events to outbox"
    end tell
end run

# calendarBridge

A local macOS-based tool to sync Microsoft Outlook calendar events with your Google Calendar using:

* **AppleScript** to export local Outlook events
* **Python** for Google Calendar API sync
* **launchd** to automatically run the sync every hour

Designed to run entirely on your Mac without server dependencies.

---

## ğŸ—–ï¸ What It Does

`calendarBridge` keeps your **local Outlook for Mac** calendar in sync with your **Google Calendar** by:

* Exporting all events from Outlook as `.ics` files (7 days back, 120 days forward)
* Cleaning and sanitizing `.ics` headers to allow parsing
* Comparing existing Google Calendar events to new ones
* Inserting new events
* Optionally removing events no longer in Outlook
* Logging all sync activity

It runs **hourly** via macOSâ€™s `launchd`, so your Google Calendar stays up to date without manual effort.

---

## ğŸ§° Project Structure

```
~/calendarBridge/
â”œâ”€â”€ outbox/                  # Holds exported .ics files (autogenerated)
â”œâ”€â”€ logs/                    # Sync logs (autogenerated)
â”œâ”€â”€ exportEvents.scpt        # AppleScript to export events from Outlook
â”œâ”€â”€ clean_ics_files.py       # Removes non-standard headers from .ics files
â”œâ”€â”€ safe_sync.py             # Compares and syncs cleaned events to Google
â”œâ”€â”€ full_sync.sh             # Runs full pipeline: export â†’ clean â†’ sync
â”œâ”€â”€ launchd/                 # Contains com.calendarBridge.full_sync.plist
â”œâ”€â”€ credentials.json         # Google API credentials (not in repo)
â”œâ”€â”€ token.json               # OAuth token (not in repo)
â”œâ”€â”€ sync_state.json          # Tracks synced events (not in repo)
â”œâ”€â”€ quarantine.txt           # Tracks problematic events (not in repo)
```

---

## ğŸš€ Setup & Usage

### 1. Google API Setup

* Create a Google API project: enable **Google Calendar API**
* Generate `credentials.json` and save it in `~/calendarBridge/`
* On first run, a browser window will open to complete OAuth. This creates `token.json`.

### 2. Install Python Dependencies

```bash
cd ~/calendarBridge
python3.9 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt  # or install manually if needed
```

### 3. Test Manually

```bash
osascript exportEvents.scpt       # Step 1: Export Outlook events
python clean_ics_files.py         # Step 2: Clean headers
python safe_sync.py               # Step 3: Sync to Google
```

### 4. Schedule with `launchd` (macOS)

```bash
mkdir -p ~/Library/LaunchAgents
cp launchd/com.calendarBridge.full_sync.plist ~/Library/LaunchAgents/
launchctl load ~/Library/LaunchAgents/com.calendarBridge.full_sync.plist
launchctl start com.calendarBridge.full_sync
```

It will run every hour on the hour, or manually trigger with:

```bash
launchctl kickstart -k gui/$(id -u)/com.calendarBridge.full_sync
```

Logs are written to `~/calendarBridge/logs/launchd.out`.

---

## âœ… Status

* [x] AppleScript export working reliably
* [x] `.ics` cleaning functional
* [x] Google Calendar sync tested (insert/update/delete)
* [x] `launchd` hourly automation confirmed

---

## ğŸ”’ .gitignore Protects:

```bash
credentials.json
token.json
sync_state.json
quarantine.txt
outbox/
logs/
.venv/
```

---

## ğŸ“„ License

Private/internal use. No license specified yet.
